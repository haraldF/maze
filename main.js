(()=>{"use strict";var t={178:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.ActionSpace=e.AllActions=void 0,e.AllActions=[0,1,2,3],e.ActionSpace=((i={})[0]={x:-1,y:0},i[1]={x:1,y:0},i[2]={x:0,y:-1},i[3]={x:0,y:1},i)},506:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Agent=void 0;var i=function(){function t(t,e,i){void 0===e&&(e=.15),void 0===i&&(i=.2),this.alpha=e,this.G=new Map,this.stateHistory=new Array([0,0]),this.randomFactor=i,this.initReward(t)}return t.prototype.chooseAction=function(e,i){var o,n=this;if(Math.random()<this.randomFactor)o=i[Math.floor(t.getRandomNumber(0,i.length))];else{var r=i.map((function(t){return e.applied(t)})).map((function(t){return t.index})).map((function(t){return n.G.get(t)})).reduce((function(t,e,i,o){return e>o[t]?i:t}),0);o=i[r]}return o},t.prototype.updateStateHistory=function(t,e){this.stateHistory.push([t.index,e])},t.prototype.learn=function(){for(var t=0,e=this.stateHistory.length-1;e>=0;--e){var i=this.stateHistory[e],o=i[0],n=i[1],r=this.G.get(o);this.G.set(o,r+this.alpha*(t-r)),t+=n}this.stateHistory=[],this.randomFactor-=1e-4},t.prototype.initReward=function(e){for(var i=0,o=e;i<o.length;i++){var n=o[i];this.G.set(n,t.getRandomNumber(-1,-.1))}},t.getRandomNumber=function(t,e){return Math.random()*(e-t)+t},t}();e.Agent=i},517:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Maze=void 0;var o=i(178),n=function(){function t(t){this.tiles=t,this.steps=0,this.allowedMoves=new Map,this.height=t.length,this.width=t[0].length,t[0][0]=2,this.robotPosition=this.newState(0,0),this.initAllowedMoves()}return t.EmptyMaze=function(t,e){return Array.from(Array(e),(function(){return Array(t).fill(0)}))},t.prototype.newState=function(t,e){var i=this;return{x:t,y:e,index:t*this.width+e,applied:function(o){return i.applied(o,t,e)}}},t.prototype.applied=function(t,e,i){var n=o.ActionSpace[t];return this.newState(e+n.x,i+n.y)},t.prototype.getNewPosition=function(t){return this.robotPosition.applied(t)},t.prototype.isAllowedMove=function(t,e){var i=t.applied(e);return!(i.x<0||i.y<0||i.x>=this.height||i.y>=this.width)&&1!==this.tiles[i.x][i.y]},t.prototype.encodeTiles=function(){for(var t=String.fromCharCode(this.width,this.height),e=0,i=0,o=0;o<this.height;++o)for(var n=0;n<this.width;++n)1===this.tiles[o][n]&&(i|=1),8==++e?(t+=String.fromCharCode(i),e=0,i=0):i<<=1;return 0!==e&&(t+=String.fromCharCode(i<<7-e)),btoa(t)},t.loadTiles=function(e){for(var i=atob(e),o=0,n=i.charCodeAt(o++),r=i.charCodeAt(o++),s=t.EmptyMaze(n,r),a=i.charCodeAt(o++),h=0,l=0;l<r;++l)for(var u=0;u<n;++u)s[l][u]=128==(128&a)?1:0,8==++h?(a=i.charCodeAt(o++),h=0):a<<=1;return s},t.prototype.initAllowedMoves=function(){var t=this;this.allowedMoves.clear();for(var e=0;e<this.height;++e)for(var i=function(i){var r=n.newState(e,i),s=o.AllActions.filter((function(e){return t.isAllowedMove(r,e)}));n.allowedMoves.set(r.index,s)},n=this,r=0;r<this.width;++r)i(r)},t.prototype.toggleTile=function(t,e){0===t&&0===e||t===this.height-1&&e==this.width-1||(this.tiles[t][e]=1===this.tiles[t][e]?0:1,this.initAllowedMoves())},t.prototype.updateMaze=function(t){this.tiles[this.robotPosition.x][this.robotPosition.y]=0,this.robotPosition=this.getNewPosition(t),++this.steps,this.tiles[this.robotPosition.x][this.robotPosition.y]=2},t.prototype.isGameOver=function(){return this.robotPosition.x===this.height-1&&this.robotPosition.y===this.width-1},t.prototype.getState=function(){return this.robotPosition},t.prototype.getAllowedMoves=function(t){return this.allowedMoves.get(t.index)},t.prototype.getReward=function(){return this.isGameOver()?0:-1},t.prototype.reset=function(){this.steps=0,this.tiles[this.robotPosition.x][this.robotPosition.y]=0,this.tiles[0][0]=2,this.robotPosition=this.newState(0,0)},t.prototype.setRobotPosition=function(t,e){var i=this.newState(t,e);this.tiles[this.robotPosition.x][this.robotPosition.y]=0,this.robotPosition=i,this.tiles[this.robotPosition.x][this.robotPosition.y]=2},t.prototype.toIndex=function(t,e){return t*this.width+e},t.prototype.resize=function(t,e){this.reset();for(var i=this.height;i<e;++i)this.tiles.push(new Array(t).fill(0));this.tiles.length=e,this.height=e;for(var o=0,n=this.tiles;o<n.length;o++){var r=n[o];r.length=t,r.fill(0,this.width)}this.width=t,this.initAllowedMoves()},t}();e.Maze=n},550:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MazeView=void 0;var i=function(){function t(t,e){this.maze=t,this.canvas=e}return t.prototype.render=function(){this.renderMaze(),void 0!==this.G&&this.renderGValues(this.G)},t.prototype.renderMaze=function(){var t,e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderGrid(e);for(var i=this.canvas.width/this.maze.width,o=this.canvas.height/this.maze.height,n=0;n<this.maze.height;++n)for(var r=this.maze.tiles[n],s=0;s<this.maze.width;++s)1==r[s]?(e.fillStyle="#000000",e.fillRect(s*i,n*o,i,o)):2==r[s]?(e.fillStyle="#00AA00",e.fillRect(s*i,n*o,i,o)):s===this.maze.width-1&&n===this.maze.height-1?(e.fillStyle="#0000FF",e.fillRect(s*i,n*o,i,o)):(null===(t=this.visited)||void 0===t?void 0:t.has(this.maze.toIndex(n,s)))&&(e.fillStyle="#eeeeee",e.fillRect(s*i,n*o,i,o))},t.prototype.renderGrid=function(t){t.beginPath(),t.strokeStyle="grey";for(var e=0;e<this.maze.height+1;++e){var i=this.canvas.height/this.maze.height*e;t.moveTo(0,i),t.lineTo(this.canvas.width,i)}for(e=0;e<this.maze.width+1;++e){var o=this.canvas.width/this.maze.width*e;t.moveTo(o,0),t.lineTo(o,this.canvas.height)}t.stroke()},t.prototype.renderGValues=function(t){var e=this.canvas.getContext("2d"),i=this.canvas.width/this.maze.width,o=this.canvas.height/this.maze.height;e.font="30px serif",e.textAlign="center",e.fillStyle="#000000",e.textBaseline="middle";for(var n=0;n<this.maze.height;++n)for(var r=0;r<this.maze.width;++r){var s=this.maze.toIndex(r,n),a=t.get(s);e.fillText(a.toFixed(4),n*i+i/2,r*o+o/2,i)}},t.prototype.solve=function(t){for(var e=this,i=new Set([0]),o=this.maze.getState();o.x!==this.maze.height-1||o.y!==this.maze.width-1;){var n=this.maze.getAllowedMoves(o),r=n.map((function(t){return e.maze.applied(t,o.x,o.y)})).map((function(e){return i.has(e.index)?void 0:t.get(e.index)})).reduce((function(t,e,i,o){return void 0!==e&&(-1===t||o[t]<e)?i:t}),-1);if(-1===r)break;o=this.maze.applied(n[r],o.x,o.y),i.add(o.index)}return i},t.prototype.setG=function(t){this.G=t,this.visited=this.solve(t)},t}();e.MazeView=i},965:function(t,e,i){var o=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))((function(n,r){function s(t){try{h(o.next(t))}catch(t){r(t)}}function a(t){try{h(o.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}h((o=o.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var i,o,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var r,s=i(506),a=i(517),h=i(550),l=null===(r=new URLSearchParams(window.location.search).get("maze"))?function(){var t=a.Maze.EmptyMaze(6,6);return t[5][0]=1,t[5][1]=1,t[5][2]=1,t[5][3]=1,t[5][4]=1,t[0][5]=1,t[1][5]=1,t[2][5]=1,t[3][5]=1,t[2][2]=1,t[2][3]=1,t[2][4]=1,t[2][5]=1,t[3][2]=1,t}():a.Maze.loadTiles(r),u=new a.Maze(l),d=document.getElementById("maze"),c=new h.MazeView(u,d);function f(){var t=window.devicePixelRatio,e=d.getBoundingClientRect(),i=e.width,o=e.height;d.width=Math.ceil(i*t),d.height=Math.ceil(o*t),c.render()}function p(){window.history.replaceState(null,"Maze","?maze="+encodeURIComponent(u.encodeTiles()))}c.render(),f(),window.addEventListener("resize",f,!1),d.onclick=function(t){var e=d.getBoundingClientRect(),i=Math.floor(t.offsetY*u.height/e.width),o=Math.floor(t.offsetX*u.width/e.height);u.toggleTile(i,o),c.render(),p()},document.getElementById("startButton").onclick=function(){return o(this,void 0,void 0,(function(){var t,e,i,o,r,a,h,l,d,f,p;return n(this,(function(n){if((t=parseFloat(document.getElementById("alpha").value))<0||t>1)return console.error("Alpha must be between 0 and 1"),[2];if((e=parseFloat(document.getElementById("epsilon").value))<0||e>1)return console.error("Epsilon must be between 0 and 1"),[2];for(i=new Array,o=Array.from(Array(u.width*u.height),(function(t,e){return e})),r=new s.Agent(o,t,e),a=0;a<5e3;++a){for(;!u.isGameOver();)h=u.getState(),l=u.getAllowedMoves(h),d=r.chooseAction(h,l),u.updateMaze(d),f=u.getState(),p=u.getReward(),r.updateStateHistory(f,p),u.steps>1e3&&u.setRobotPosition(u.height-1,u.width-1);r.learn(),i.push(u.steps),u.reset()}return c.setG(r.G),c.render(),function(t){var e=[{x:t.map((function(t,e){return e})),y:t,mode:"lines"}];Plotly.newPlot("plot",e,{title:"Move History",xaxis:{title:"Episodes"},yaxis:{title:"StepCount"}})}(i),[2]}))}))};var v=document.getElementById("width"),y=document.getElementById("height");function w(t,e,i){return t<=e?e:t>=i?i:t}function g(){var t=w(Number.parseInt(v.value),1,127),e=w(Number.parseInt(y.value),1,127);u.resize(t,e),c.render(),p()}v.value=u.width.toString(),y.value=u.height.toString(),v.oninput=g,y.oninput=g}},e={};!function i(o){if(e[o])return e[o].exports;var n=e[o]={exports:{}};return t[o].call(n.exports,n,n.exports,i),n.exports}(965)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9qc21hemUvLi9BY3Rpb25TcGFjZS50cyIsIndlYnBhY2s6Ly9qc21hemUvLi9BZ2VudC50cyIsIndlYnBhY2s6Ly9qc21hemUvLi9NYXplLnRzIiwid2VicGFjazovL2pzbWF6ZS8uL01hemVWaWV3LnRzIiwid2VicGFjazovL2pzbWF6ZS8uL21haW4udHMiLCJ3ZWJwYWNrOi8vanNtYXplL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2pzbWF6ZS93ZWJwYWNrL3N0YXJ0dXAiXSwibmFtZXMiOlsiQWxsQWN0aW9ucyIsIkFjdGlvblNwYWNlIiwieCIsInkiLCJzdGF0ZXMiLCJhbHBoYSIsImluaXRpYWxSYW5kb21GYWN0b3IiLCJHIiwiTWFwIiwic3RhdGVIaXN0b3J5IiwiQXJyYXkiLCJ0aGlzIiwicmFuZG9tRmFjdG9yIiwiaW5pdFJld2FyZCIsImNob29zZUFjdGlvbiIsInN0YXRlIiwiYWxsb3dlZE1vdmVzIiwibmV4dE1vdmUiLCJNYXRoIiwicmFuZG9tIiwiZmxvb3IiLCJBZ2VudCIsImdldFJhbmRvbU51bWJlciIsImxlbmd0aCIsIm5leHRNb3ZlSW5kZXgiLCJtYXAiLCJhY3Rpb24iLCJhcHBsaWVkIiwibmV3U3RhdGUiLCJpbmRleCIsImdldCIsInJlZHVjZSIsIm1heFZhbHVlSW5kZXgiLCJjdXJyZW50VmFsdWUiLCJhcnJheSIsInVwZGF0ZVN0YXRlSGlzdG9yeSIsInJld2FyZCIsInB1c2giLCJsZWFybiIsInRhcmdldCIsImkiLCJwcmV2aW91c1Jld2FyZCIsInNldCIsIm1pbiIsIm1heCIsInRpbGVzIiwic3RlcHMiLCJoZWlnaHQiLCJ3aWR0aCIsInJvYm90UG9zaXRpb24iLCJpbml0QWxsb3dlZE1vdmVzIiwiRW1wdHlNYXplIiwiZnJvbSIsImZpbGwiLCJtb3ZlIiwiZ2V0TmV3UG9zaXRpb24iLCJpc0FsbG93ZWRNb3ZlIiwidGFyZ2V0UG9zaXRpb24iLCJlbmNvZGVUaWxlcyIsImJ5dGVzIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwiYml0IiwiY3VycmVudEJ5dGUiLCJidG9hIiwibG9hZFRpbGVzIiwiZW5jb2RlZFN0cmluZyIsImF0b2IiLCJjdXJyZW50Qnl0ZUluZGV4IiwiY2hhckNvZGVBdCIsIk1hemUiLCJjbGVhciIsImZpbHRlciIsInRvZ2dsZVRpbGUiLCJyb3ciLCJjb2x1bW4iLCJ1cGRhdGVNYXplIiwiaXNHYW1lT3ZlciIsImdldFN0YXRlIiwiZ2V0QWxsb3dlZE1vdmVzIiwiZ2V0UmV3YXJkIiwicmVzZXQiLCJzZXRSb2JvdFBvc2l0aW9uIiwibmV3UG9zIiwidG9JbmRleCIsInJlc2l6ZSIsIm1hemUiLCJjYW52YXMiLCJyZW5kZXIiLCJyZW5kZXJNYXplIiwidW5kZWZpbmVkIiwicmVuZGVyR1ZhbHVlcyIsImN0eCIsImdldENvbnRleHQiLCJjbGVhclJlY3QiLCJyZW5kZXJHcmlkIiwidGlsZVdpZHRoIiwidGlsZUhlaWdodCIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwidmlzaXRlZCIsImhhcyIsImJlZ2luUGF0aCIsInN0cm9rZVN0eWxlIiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlIiwiZm9udCIsInRleHRBbGlnbiIsInRleHRCYXNlbGluZSIsImdWYWx1ZSIsImZpbGxUZXh0IiwidG9GaXhlZCIsInNvbHZlIiwiU2V0IiwiYmVzdE1vdmVJbmRleCIsIm1heEluZGV4IiwiYWRkIiwic2V0RyIsIk1hemVWaWV3Iiwic2F2ZWRNYXplIiwiVVJMU2VhcmNoUGFyYW1zIiwid2luZG93IiwibG9jYXRpb24iLCJzZWFyY2giLCJkZWZhdWx0TWF6ZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJtYXplVmlldyIsInJlc2l6ZUNhbnZhcyIsImRwciIsImRldmljZVBpeGVsUmF0aW8iLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJjZWlsIiwidXBkYXRlVVJJIiwiaGlzdG9yeSIsInJlcGxhY2VTdGF0ZSIsImVuY29kZVVSSUNvbXBvbmVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbmNsaWNrIiwiZXZlbnQiLCJyZWN0Iiwib2Zmc2V0WSIsIm9mZnNldFgiLCJwYXJzZUZsb2F0IiwidmFsdWUiLCJjb25zb2xlIiwiZXJyb3IiLCJlcHNpbG9uIiwibW92ZUhpc3RvcnkiLCJfIiwicm9ib3QiLCJkYXRhIiwibW9kZSIsIlBsb3RseSIsIm5ld1Bsb3QiLCJ0aXRsZSIsInhheGlzIiwieWF4aXMiLCJwbG90TW92ZUhpc3RvcnkiLCJ3aWR0aElucHV0IiwiaGVpZ2h0SW5wdXQiLCJjbGFtcCIsIm51bSIsInJlc2l6ZU1hemUiLCJOdW1iZXIiLCJwYXJzZUludCIsInRvU3RyaW5nIiwib25pbnB1dCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCJdLCJtYXBwaW5ncyI6IitIQU1hLEVBQUFBLFdBQWEsQ0FBQyxFQUFELE9BRWIsRUFBQUMsY0FBVyxNQUNwQixHQUFhLENBQUVDLEdBQUksRUFBR0MsRUFBRyxHQUN6QixLQUFlLENBQUVELEVBQUcsRUFBR0MsRUFBRyxHQUMxQixLQUFlLENBQUVELEVBQUcsRUFBR0MsR0FBSSxHQUMzQixLQUFnQixDQUFFRCxFQUFHLEVBQUdDLEVBQUcsRyxnRkNUL0IsaUJBTUksV0FBWUMsRUFDUUMsRUFDaEJDLFFBRGdCLElBQUFELE1BQUEsVUFDaEIsSUFBQUMsTUFBQSxJQURnQixLQUFBRCxRQUxKLEtBQUFFLEVBQUksSUFBSUMsSUFDaEIsS0FBQUMsYUFBZSxJQUFJQyxNQUF3QixDQUFDLEVBQUcsSUFNbkRDLEtBQUtDLGFBQWVOLEVBQ3BCSyxLQUFLRSxXQUFXVCxHQXdEeEIsT0FyREksWUFBQVUsYUFBQSxTQUFhQyxFQUFjQyxHQUEzQixJQUNRQyxFQURSLE9BR0ksR0FEbUJDLEtBQUtDLFNBQ0xSLEtBQUtDLGFBSXBCSyxFQUFXRCxFQURhRSxLQUFLRSxNQUFNQyxFQUFNQyxnQkFBZ0IsRUFBR04s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TUMsRUFBYXhILEVBQWFDLEdBQ3JDLE9BQU91SCxHQUFPeEgsRUFBTUEsRUFBTXdILEdBQU92SCxFQUFNQSxFQUFNdUgsRUFHakQsU0FBU0MsSUFDTCxJQUFNcEgsRUFBUWtILEVBQU1HLE9BQU9DLFNBQVNOLEVBQVdmLE9BQVEsRUFBRyxLQUNwRGxHLEVBQVNtSCxFQUFNRyxPQUFPQyxTQUFTTCxFQUFZaEIsT0FBUSxFQUFHLEtBRTVEM0QsRUFBS0QsT0FBT3JDLEVBQU9ELEdBQ25CaUYsRUFBU3hDLFNBQ1Q4QyxJQWJKMEIsRUFBV2YsTUFBUTNELEVBQUt0QyxNQUFNdUgsV0FDOUJOLEVBQVloQixNQUFRM0QsRUFBS3ZDLE9BQU93SCxXQWVoQ1AsRUFBV1EsUUFBVUosRUFDckJILEVBQVlPLFFBQVVKLElDakxsQkssRUFBMkIsSUFHL0IsU0FBU0MsRUFBb0JDLEdBRTVCLEdBQUdGLEVBQXlCRSxHQUMzQixPQUFPRixFQUF5QkUsR0FBVUMsUUFHM0MsSUFBSUMsRUFBU0osRUFBeUJFLEdBQVksQ0FHakRDLFFBQVMsSUFPVixPQUhBRSxFQUFvQkgsR0FBVUksS0FBS0YsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHcEVHLEVBQU9ELFFDakJmRixDQUFvQixNIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgZW51bSBBY3Rpb24ge1xuICAgIFVwLCBEb3duLCBMZWZ0LCBSaWdodFxufTtcblxuZXhwb3J0IHR5cGUgQWN0aW9ucyA9IGtleW9mIHR5cGVvZiBBY3Rpb247XG5cbmV4cG9ydCBjb25zdCBBbGxBY3Rpb25zID0gWyBBY3Rpb24uVXAsIEFjdGlvbi5Eb3duLCBBY3Rpb24uTGVmdCwgQWN0aW9uLlJpZ2h0IF07XG5cbmV4cG9ydCBjb25zdCBBY3Rpb25TcGFjZTogeyBba2V5IGluIEFjdGlvbl0gOiB7IHg6IG51bWJlciwgeTogbnVtYmVyIH0gfSA9IHtcbiAgICBbQWN0aW9uLlVwXTogeyB4OiAtMSwgeTogMCB9LFxuICAgIFtBY3Rpb24uRG93bl06IHsgeDogMSwgeTogMCB9LFxuICAgIFtBY3Rpb24uTGVmdF06IHsgeDogMCwgeTogLTEgfSxcbiAgICBbQWN0aW9uLlJpZ2h0XTogeyB4OiAwLCB5OiAxIH1cbn07XG4iLCJpbXBvcnQgeyBBY3Rpb24sIEFjdGlvblNwYWNlIH0gZnJvbSAnLi9BY3Rpb25TcGFjZSc7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4vU3RhdGUnO1xuXG5leHBvcnQgY2xhc3MgQWdlbnQge1xuXG4gICAgcHVibGljIHJlYWRvbmx5IEcgPSBuZXcgTWFwPG51bWJlciwgbnVtYmVyPigpO1xuICAgIHByaXZhdGUgc3RhdGVIaXN0b3J5ID0gbmV3IEFycmF5PFtudW1iZXIsIG51bWJlcl0+KFswLCAwXSk7XG4gICAgcHJpdmF0ZSByYW5kb21GYWN0b3I6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHN0YXRlczogQXJyYXk8bnVtYmVyPixcbiAgICAgICAgcHVibGljIHJlYWRvbmx5IGFscGhhOiBudW1iZXIgPSAwLjE1LFxuICAgICAgICBpbml0aWFsUmFuZG9tRmFjdG9yID0gMC4yKSB7XG4gICAgICAgIHRoaXMucmFuZG9tRmFjdG9yID0gaW5pdGlhbFJhbmRvbUZhY3RvcjtcbiAgICAgICAgdGhpcy5pbml0UmV3YXJkKHN0YXRlcyk7XG4gICAgfVxuXG4gICAgY2hvb3NlQWN0aW9uKHN0YXRlOiBTdGF0ZSwgYWxsb3dlZE1vdmVzOiBBcnJheTxBY3Rpb24+KTogQWN0aW9uIHtcbiAgICAgICAgbGV0IG5leHRNb3ZlOiBBY3Rpb247XG4gICAgICAgIGxldCByYW5kb21OdW1iZXIgPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgICBpZiAocmFuZG9tTnVtYmVyIDwgdGhpcy5yYW5kb21GYWN0b3IpIHtcbiAgICAgICAgICAgIC8vIGV4cGxvcmF0b3J5IG1vdmVcbiAgICAgICAgICAgIC8vIHBpY2tzIGEgcmFuZG9tIG1vdmUgb2YgYWxsIGFsbG93ZWQgbW92ZXNcbiAgICAgICAgICAgIGNvbnN0IHJhbmRvbU1vdmVJbmRleCA9IE1hdGguZmxvb3IoQWdlbnQuZ2V0UmFuZG9tTnVtYmVyKDAsIGFsbG93ZWRNb3Zlcy5sZW5ndGgpKTtcbiAgICAgICAgICAgIG5leHRNb3ZlID0gYWxsb3dlZE1vdmVzW3JhbmRvbU1vdmVJbmRleF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBleHBsb2l0YXRpb24gbW92ZVxuICAgICAgICAgICAgLy8gcGlja3MgdGhlIG1vdmUgd2l0aCB0aGUgaGlnaGVzdCBHIHZhbHVlXG4gICAgICAgICAgICBjb25zdCBuZXh0TW92ZUluZGV4ID0gYWxsb3dlZE1vdmVzXG4gICAgICAgICAgICAgICAgLm1hcChhY3Rpb24gPT4gc3RhdGUuYXBwbGllZChhY3Rpb24pKVxuICAgICAgICAgICAgICAgIC5tYXAobmV3U3RhdGUgPT4gbmV3U3RhdGUuaW5kZXgpXG4gICAgICAgICAgICAgICAgLm1hcChpbmRleCA9PiB0aGlzLkcuZ2V0KGluZGV4KSEpXG4gICAgICAgICAgICAgICAgLnJlZHVjZSgobWF4VmFsdWVJbmRleCwgY3VycmVudFZhbHVlLCBpbmRleCwgYXJyYXkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRWYWx1ZSA+IGFycmF5W21heFZhbHVlSW5kZXhdID8gaW5kZXggOiBtYXhWYWx1ZUluZGV4O1xuICAgICAgICAgICAgICAgIH0sIDApO1xuXG4gICAgICAgICAgICBuZXh0TW92ZSA9IGFsbG93ZWRNb3Zlc1tuZXh0TW92ZUluZGV4XTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBuZXh0TW92ZTtcbiAgICB9XG5cbiAgICB1cGRhdGVTdGF0ZUhpc3Rvcnkoc3RhdGU6IFN0YXRlLCByZXdhcmQ6IG51bWJlcikge1xuICAgICAgICB0aGlzLnN0YXRlSGlzdG9yeS5wdXNoKFtzdGF0ZS5pbmRleCwgcmV3YXJkXSk7XG4gICAgfVxuXG4gICAgbGVhcm4oKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSAwO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSB0aGlzLnN0YXRlSGlzdG9yeS5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICAgICAgY29uc3QgW3N0YXRlLCByZXdhcmRdID0gdGhpcy5zdGF0ZUhpc3RvcnlbaV07XG4gICAgICAgICAgICBjb25zdCBwcmV2aW91c1Jld2FyZCA9IHRoaXMuRy5nZXQoc3RhdGUpITtcbiAgICAgICAgICAgIHRoaXMuRy5zZXQoc3RhdGUsIHByZXZpb3VzUmV3YXJkICsgdGhpcy5hbHBoYSAqICh0YXJnZXQgLSBwcmV2aW91c1Jld2FyZCkpO1xuICAgICAgICAgICAgdGFyZ2V0ICs9IHJld2FyZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc3RhdGVIaXN0b3J5ID0gW107XG5cbiAgICAgICAgdGhpcy5yYW5kb21GYWN0b3IgLT0gMTBlLTU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0UmV3YXJkKHN0YXRlczogQXJyYXk8bnVtYmVyPikge1xuICAgICAgICBmb3IgKGNvbnN0IHN0YXRlIG9mIHN0YXRlcykge1xuICAgICAgICAgICAgdGhpcy5HLnNldChzdGF0ZSwgQWdlbnQuZ2V0UmFuZG9tTnVtYmVyKC0xLjAsIC0wLjEpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIGdldFJhbmRvbU51bWJlcihtaW46IG51bWJlciwgbWF4OiBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSArIG1pbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBY3Rpb24sIEFjdGlvblNwYWNlLCBBbGxBY3Rpb25zIH0gZnJvbSAnLi9BY3Rpb25TcGFjZSc7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4vU3RhdGUnO1xuXG5leHBvcnQgY29uc3QgZW51bSBUaWxlVHlwZSB7XG4gICAgRW1wdHksXG4gICAgV2FsbCxcbiAgICBSb2JvdFxufTtcblxuZXhwb3J0IGNsYXNzIE1hemUge1xuICAgIGhlaWdodDogbnVtYmVyO1xuICAgIHdpZHRoOiBudW1iZXI7XG4gICAgcHVibGljIHN0ZXBzID0gMDtcblxuICAgIHB1YmxpYyByb2JvdFBvc2l0aW9uO1xuICAgIHB1YmxpYyBhbGxvd2VkTW92ZXMgPSBuZXcgTWFwPG51bWJlciwgQXJyYXk8QWN0aW9uPj4oKTtcblxuICAgIHN0YXRpYyBFbXB0eU1hemUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oQXJyYXkoaGVpZ2h0KSwgKCkgPT4gQXJyYXkod2lkdGgpLmZpbGwoVGlsZVR5cGUuRW1wdHkpKTtcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVhZG9ubHkgdGlsZXM6IEFycmF5PCBBcnJheTxUaWxlVHlwZT4gPikge1xuICAgICAgICB0aGlzLmhlaWdodCA9IHRpbGVzLmxlbmd0aDtcbiAgICAgICAgdGhpcy53aWR0aCA9IHRpbGVzWzBdLmxlbmd0aDtcblxuICAgICAgICB0aWxlc1swXVswXSA9IFRpbGVUeXBlLlJvYm90O1xuICAgICAgICB0aGlzLnJvYm90UG9zaXRpb24gPSB0aGlzLm5ld1N0YXRlKDAsIDApO1xuXG4gICAgICAgIHRoaXMuaW5pdEFsbG93ZWRNb3ZlcygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgbmV3U3RhdGUoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBTdGF0ZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4LFxuICAgICAgICAgICAgeSxcbiAgICAgICAgICAgIGluZGV4OiB4ICogdGhpcy53aWR0aCArIHksXG4gICAgICAgICAgICBhcHBsaWVkOiAoYWN0aW9uOiBBY3Rpb24pID0+IHRoaXMuYXBwbGllZChhY3Rpb24sIHgsIHkpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXBwbGllZChhY3Rpb246IEFjdGlvbiwgeDogbnVtYmVyLCB5OiBudW1iZXIpOiBTdGF0ZSB7XG4gICAgICAgIGNvbnN0IG1vdmUgPSBBY3Rpb25TcGFjZVthY3Rpb25dO1xuICAgICAgICByZXR1cm4gdGhpcy5uZXdTdGF0ZSh4ICsgbW92ZS54LCB5ICsgbW92ZS55KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldE5ld1Bvc2l0aW9uKGFjdGlvbjogQWN0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvYm90UG9zaXRpb24uYXBwbGllZChhY3Rpb24pO1xuICAgIH1cblxuICAgIGlzQWxsb3dlZE1vdmUoc3RhdGU6IFN0YXRlLCBhY3Rpb246IEFjdGlvbik6IGJvb2xlYW4ge1xuXG4gICAgICAgIGNvbnN0IHRhcmdldFBvc2l0aW9uID0gc3RhdGUuYXBwbGllZChhY3Rpb24pO1xuXG4gICAgICAgIGlmICh0YXJnZXRQb3NpdGlvbi54IDwgMCB8fCB0YXJnZXRQb3NpdGlvbi55IDwgMFxuICAgICAgICAgICAgfHwgdGFyZ2V0UG9zaXRpb24ueCA+PSB0aGlzLmhlaWdodCB8fCB0YXJnZXRQb3NpdGlvbi55ID49IHRoaXMud2lkdGgpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMudGlsZXNbdGFyZ2V0UG9zaXRpb24ueF1bdGFyZ2V0UG9zaXRpb24ueV0gIT09IFRpbGVUeXBlLldhbGw7XG4gICAgfVxuXG4gICAgLy8gZW5jb2RlcyB0aGUgY3VycmVudCBtYXplIHRvIGEgYmFzZTY0IHN0cmluZ1xuICAgIGVuY29kZVRpbGVzKCk6IHN0cmluZyB7XG4gICAgICAgIGxldCBieXRlcyA9IFN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuXG4gICAgICAgIGxldCBiaXQgPSAwO1xuICAgICAgICBsZXQgY3VycmVudEJ5dGUgPSAwO1xuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMuaGVpZ2h0OyArK3gpIHtcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgdGhpcy53aWR0aDsgKyt5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGlsZXNbeF1beV0gPT09IFRpbGVUeXBlLldhbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgfD0gMTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoKytiaXQgPT09IDgpIHtcbiAgICAgICAgICAgICAgICAgICAgYnl0ZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjdXJyZW50Qnl0ZSk7XG4gICAgICAgICAgICAgICAgICAgIGJpdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlID0gMDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Qnl0ZSA8PD0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYml0ICE9PSAwKSB7XG4gICAgICAgICAgICBieXRlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGN1cnJlbnRCeXRlIDw8IDcgLSBiaXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGJ0b2EoYnl0ZXMpO1xuICAgIH1cblxuICAgIHN0YXRpYyBsb2FkVGlsZXMoZW5jb2RlZFN0cmluZzogc3RyaW5nKTogQXJyYXk8QXJyYXk8VGlsZVR5cGU+PiB7XG4gICAgICAgIGNvbnN0IGJ5dGVzID0gYXRvYihlbmNvZGVkU3RyaW5nKTtcblxuICAgICAgICBsZXQgY3VycmVudEJ5dGVJbmRleCA9IDA7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gYnl0ZXMuY2hhckNvZGVBdChjdXJyZW50Qnl0ZUluZGV4KyspO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBieXRlcy5jaGFyQ29kZUF0KGN1cnJlbnRCeXRlSW5kZXgrKyk7XG5cbiAgICAgICAgY29uc3QgdGlsZXMgPSBNYXplLkVtcHR5TWF6ZSh3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICBsZXQgY3VycmVudEJ5dGUgPSBieXRlcy5jaGFyQ29kZUF0KGN1cnJlbnRCeXRlSW5kZXgrKyk7XG4gICAgICAgIGxldCBiaXQgPSAwO1xuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IGhlaWdodDsgKyt4KSB7XG4gICAgICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHdpZHRoOyArK3kpIHtcbiAgICAgICAgICAgICAgICB0aWxlc1t4XVt5XSA9ICgoY3VycmVudEJ5dGUgJiAxMjgpID09PSAxMjgpID8gVGlsZVR5cGUuV2FsbCA6IFRpbGVUeXBlLkVtcHR5O1xuICAgICAgICAgICAgICAgIGlmICgrK2JpdCA9PT0gOCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Qnl0ZSA9IGJ5dGVzLmNoYXJDb2RlQXQoY3VycmVudEJ5dGVJbmRleCsrKTtcbiAgICAgICAgICAgICAgICAgICAgYml0ID0gMDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Qnl0ZSA8PD0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGlsZXM7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0QWxsb3dlZE1vdmVzKCkge1xuICAgICAgICB0aGlzLmFsbG93ZWRNb3Zlcy5jbGVhcigpO1xuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMuaGVpZ2h0OyArK3gpIHtcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgdGhpcy53aWR0aDsgKyt5KSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLm5ld1N0YXRlKHgsIHkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsbG93ZWRNb3ZlcyA9IEFsbEFjdGlvbnMuZmlsdGVyKGFjdGlvbiA9PlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzQWxsb3dlZE1vdmUoc3RhdGUsIGFjdGlvbilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHRoaXMuYWxsb3dlZE1vdmVzLnNldChzdGF0ZS5pbmRleCwgYWxsb3dlZE1vdmVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRvZ2dsZVRpbGUocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKSB7XG4gICAgICAgIGlmICgocm93ID09PSAwICYmIGNvbHVtbiA9PT0gMCkgfHwgKHJvdyA9PT0gdGhpcy5oZWlnaHQgLSAxICYmIGNvbHVtbiA9PSB0aGlzLndpZHRoIC0gMSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudGlsZXNbcm93XVtjb2x1bW5dID0gdGhpcy50aWxlc1tyb3ddW2NvbHVtbl0gPT09IFRpbGVUeXBlLldhbGwgPyBUaWxlVHlwZS5FbXB0eSA6IFRpbGVUeXBlLldhbGw7XG4gICAgICAgIHRoaXMuaW5pdEFsbG93ZWRNb3ZlcygpO1xuICAgIH1cblxuICAgIHVwZGF0ZU1hemUoYWN0aW9uOiBBY3Rpb24pIHtcbiAgICAgICAgdGhpcy50aWxlc1t0aGlzLnJvYm90UG9zaXRpb24ueF1bdGhpcy5yb2JvdFBvc2l0aW9uLnldID0gVGlsZVR5cGUuRW1wdHk7XG4gICAgICAgIHRoaXMucm9ib3RQb3NpdGlvbiA9IHRoaXMuZ2V0TmV3UG9zaXRpb24oYWN0aW9uKTtcbiAgICAgICAgKyt0aGlzLnN0ZXBzO1xuICAgICAgICB0aGlzLnRpbGVzW3RoaXMucm9ib3RQb3NpdGlvbi54XVt0aGlzLnJvYm90UG9zaXRpb24ueV0gPSBUaWxlVHlwZS5Sb2JvdDtcbiAgICB9XG5cbiAgICBpc0dhbWVPdmVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb2JvdFBvc2l0aW9uLnggPT09IHRoaXMuaGVpZ2h0IC0gMSAmJiB0aGlzLnJvYm90UG9zaXRpb24ueSA9PT0gdGhpcy53aWR0aCAtIDE7XG4gICAgfVxuXG4gICAgZ2V0U3RhdGUoKSB7IHJldHVybiB0aGlzLnJvYm90UG9zaXRpb247IH1cblxuICAgIGdldEFsbG93ZWRNb3ZlcyhzdGF0ZTogU3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsb3dlZE1vdmVzLmdldChzdGF0ZS5pbmRleCk7XG4gICAgfVxuXG4gICAgZ2V0UmV3YXJkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc0dhbWVPdmVyKCkgPyAwIDogLTE7XG4gICAgfVxuXG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMuc3RlcHMgPSAwO1xuICAgICAgICB0aGlzLnRpbGVzW3RoaXMucm9ib3RQb3NpdGlvbi54XVt0aGlzLnJvYm90UG9zaXRpb24ueV0gPSBUaWxlVHlwZS5FbXB0eTtcbiAgICAgICAgdGhpcy50aWxlc1swXVswXSA9IFRpbGVUeXBlLlJvYm90O1xuICAgICAgICB0aGlzLnJvYm90UG9zaXRpb24gPSB0aGlzLm5ld1N0YXRlKDAsIDApO1xuICAgIH1cblxuICAgIHNldFJvYm90UG9zaXRpb24oeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICAgICAgY29uc3QgbmV3UG9zID0gdGhpcy5uZXdTdGF0ZSh4LCB5KTtcbiAgICAgICAgdGhpcy50aWxlc1t0aGlzLnJvYm90UG9zaXRpb24ueF1bdGhpcy5yb2JvdFBvc2l0aW9uLnldID0gVGlsZVR5cGUuRW1wdHk7XG4gICAgICAgIHRoaXMucm9ib3RQb3NpdGlvbiA9IG5ld1BvcztcbiAgICAgICAgdGhpcy50aWxlc1t0aGlzLnJvYm90UG9zaXRpb24ueF1bdGhpcy5yb2JvdFBvc2l0aW9uLnldID0gVGlsZVR5cGUuUm9ib3Q7XG4gICAgfVxuXG4gICAgdG9JbmRleCh4OiBudW1iZXIsIHk6IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB4ICogdGhpcy53aWR0aCArIHk7XG4gICAgfVxuXG4gICAgcmVzaXplKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5oZWlnaHQ7IGkgPCBoZWlnaHQ7ICsraSkge1xuICAgICAgICAgICAgdGhpcy50aWxlcy5wdXNoKG5ldyBBcnJheSh3aWR0aCkuZmlsbChUaWxlVHlwZS5FbXB0eSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudGlsZXMubGVuZ3RoID0gaGVpZ2h0O1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcblxuICAgICAgICBmb3IgKGxldCByb3cgb2YgdGhpcy50aWxlcykge1xuICAgICAgICAgICAgcm93Lmxlbmd0aCA9IHdpZHRoO1xuICAgICAgICAgICAgcm93LmZpbGwoVGlsZVR5cGUuRW1wdHksIHRoaXMud2lkdGgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcblxuICAgICAgICB0aGlzLmluaXRBbGxvd2VkTW92ZXMoKTtcbiAgICB9XG59O1xuIiwiaW1wb3J0IHsgTWF6ZSwgVGlsZVR5cGUgfSBmcm9tIFwiLi9NYXplXCI7XG5cbmV4cG9ydCBjbGFzcyBNYXplVmlldyB7XG5cbiAgICBwcml2YXRlIEc/OiBNYXA8bnVtYmVyLCBudW1iZXI+O1xuICAgIHByaXZhdGUgdmlzaXRlZD86IFNldDxudW1iZXI+O1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIHJlYWRvbmx5IG1hemU6IE1hemUsIHB1YmxpYyByZWFkb25seSBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50KSB7fVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICB0aGlzLnJlbmRlck1hemUoKTtcbiAgICAgICAgaWYgKHRoaXMuRyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlckdWYWx1ZXModGhpcy5HKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlck1hemUoKSB7XG4gICAgICAgIGNvbnN0IGN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJykhO1xuICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyR3JpZChjdHgpO1xuXG4gICAgICAgIGNvbnN0IHRpbGVXaWR0aCA9IHRoaXMuY2FudmFzLndpZHRoIC8gdGhpcy5tYXplLndpZHRoO1xuICAgICAgICBjb25zdCB0aWxlSGVpZ2h0ID0gdGhpcy5jYW52YXMuaGVpZ2h0IC8gdGhpcy5tYXplLmhlaWdodDtcblxuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMubWF6ZS5oZWlnaHQ7ICsreCkge1xuICAgICAgICAgICAgY29uc3Qgcm93ID0gdGhpcy5tYXplLnRpbGVzW3hdO1xuICAgICAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCB0aGlzLm1hemUud2lkdGg7ICsreSkge1xuICAgICAgICAgICAgICAgIGlmIChyb3dbeV0gPT0gVGlsZVR5cGUuV2FsbCkge1xuICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gXCIjMDAwMDAwXCI7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdChcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgKiB0aWxlV2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICB4ICogdGlsZUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbGVXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbGVIZWlnaHQpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyb3dbeV0gPT0gVGlsZVR5cGUuUm9ib3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiIzAwQUEwMFwiO1xuICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoXG4gICAgICAgICAgICAgICAgICAgICAgICB5ICogdGlsZVdpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgeCAqIHRpbGVIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aWxlV2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aWxlSGVpZ2h0KVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoeSA9PT0gdGhpcy5tYXplLndpZHRoIC0gMSAmJiB4ID09PSB0aGlzLm1hemUuaGVpZ2h0IC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gXCIjMDAwMEZGXCI7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdChcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgKiB0aWxlV2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICB4ICogdGlsZUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbGVXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbGVIZWlnaHQpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZpc2l0ZWQ/Lmhhcyh0aGlzLm1hemUudG9JbmRleCh4LCB5KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiI2VlZWVlZVwiO1xuICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoXG4gICAgICAgICAgICAgICAgICAgICAgICB5ICogdGlsZVdpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgeCAqIHRpbGVIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aWxlV2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aWxlSGVpZ2h0KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyR3JpZChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCkge1xuICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IFwiZ3JleVwiO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubWF6ZS5oZWlnaHQgKyAxOyArK2kpIHtcbiAgICAgICAgICAgIGNvbnN0IHkgPSAodGhpcy5jYW52YXMuaGVpZ2h0IC8gdGhpcy5tYXplLmhlaWdodCkgKiBpO1xuICAgICAgICAgICAgY3R4Lm1vdmVUbygwLCB5KTtcbiAgICAgICAgICAgIGN0eC5saW5lVG8odGhpcy5jYW52YXMud2lkdGgsIHkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tYXplLndpZHRoICsgMTsgKytpKSB7XG4gICAgICAgICAgICBjb25zdCB4ID0gKHRoaXMuY2FudmFzLndpZHRoIC8gdGhpcy5tYXplLndpZHRoKSAqIGk7XG4gICAgICAgICAgICBjdHgubW92ZVRvKHgsIDApO1xuICAgICAgICAgICAgY3R4LmxpbmVUbyh4LCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICB9XG5cbiAgICByZW5kZXJHVmFsdWVzKEc6IE1hcDxudW1iZXIsIG51bWJlcj4pIHtcbiAgICAgICAgY29uc3QgY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKSE7XG5cbiAgICAgICAgY29uc3QgdGlsZVdpZHRoID0gdGhpcy5jYW52YXMud2lkdGggLyB0aGlzLm1hemUud2lkdGg7XG4gICAgICAgIGNvbnN0IHRpbGVIZWlnaHQgPSB0aGlzLmNhbnZhcy5oZWlnaHQgLyB0aGlzLm1hemUuaGVpZ2h0O1xuXG4gICAgICAgIGN0eC5mb250ID0gJzMwcHggc2VyaWYnO1xuICAgICAgICBjdHgudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSAnIzAwMDAwMCc7XG4gICAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJztcblxuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCB0aGlzLm1hemUuaGVpZ2h0OyArK3Jvdykge1xuICAgICAgICAgICAgZm9yIChsZXQgY29sdW1uID0gMDsgY29sdW1uIDwgdGhpcy5tYXplLndpZHRoOyArK2NvbHVtbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5tYXplLnRvSW5kZXgoY29sdW1uLCByb3cpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGdWYWx1ZSA9IEcuZ2V0KGluZGV4KSE7XG5cbiAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQoZ1ZhbHVlLnRvRml4ZWQoNCksIHJvdyAqIHRpbGVXaWR0aCArIHRpbGVXaWR0aCAvIDIsIGNvbHVtbiAqIHRpbGVIZWlnaHQgKyB0aWxlSGVpZ2h0IC8gMiwgdGlsZVdpZHRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNvbHZlKEc6IE1hcDxudW1iZXIsIG51bWJlcj4pIHtcbiAgICAgICAgY29uc3QgdmlzaXRlZCA9IG5ldyBTZXQ8bnVtYmVyPihbMF0pO1xuICAgICAgICBsZXQgc3RhdGUgPSB0aGlzLm1hemUuZ2V0U3RhdGUoKTtcblxuICAgICAgICB3aGlsZSAoc3RhdGUueCAhPT0gdGhpcy5tYXplLmhlaWdodCAtMSB8fCBzdGF0ZS55ICE9PSB0aGlzLm1hemUud2lkdGggLSAxKSB7XG4gICAgICAgICAgICBjb25zdCBhbGxvd2VkTW92ZXMgPSB0aGlzLm1hemUuZ2V0QWxsb3dlZE1vdmVzKHN0YXRlKSE7XG4gICAgICAgICAgICBjb25zdCBiZXN0TW92ZUluZGV4ID0gYWxsb3dlZE1vdmVzLm1hcChhY3Rpb24gPT5cbiAgICAgICAgICAgICAgICB0aGlzLm1hemUuYXBwbGllZChhY3Rpb24sIHN0YXRlLngsIHN0YXRlLnkpXG4gICAgICAgICAgICApLm1hcChzdGF0ZSA9PlxuICAgICAgICAgICAgICAgIHZpc2l0ZWQuaGFzKHN0YXRlLmluZGV4KSA/IHVuZGVmaW5lZCA6IEcuZ2V0KHN0YXRlLmluZGV4KVxuICAgICAgICAgICAgKS5yZWR1Y2UoKG1heEluZGV4OiBudW1iZXIsIGN1cnJlbnRWYWx1ZSwgaW5kZXgsIGFycmF5KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIChtYXhJbmRleCA9PT0gLTEgfHwgYXJyYXlbbWF4SW5kZXhdISA8IGN1cnJlbnRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbWF4SW5kZXg7XG4gICAgICAgICAgICB9LCAtMSk7XG5cbiAgICAgICAgICAgIGlmIChiZXN0TW92ZUluZGV4ID09PSAtMSkgLy8gbm8gYmVzdCBtb3ZlIC0gbWF6ZSBub3Qgc29sdmFibGUuIEZyZWFrIG91dFxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgIHN0YXRlID0gdGhpcy5tYXplLmFwcGxpZWQoYWxsb3dlZE1vdmVzW2Jlc3RNb3ZlSW5kZXhdLCBzdGF0ZS54LCBzdGF0ZS55KTtcbiAgICAgICAgICAgIHZpc2l0ZWQuYWRkKHN0YXRlLmluZGV4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2aXNpdGVkO1xuICAgIH1cblxuICAgIHNldEcoRzogTWFwPG51bWJlciwgbnVtYmVyPikge1xuICAgICAgICB0aGlzLkcgPSBHO1xuICAgICAgICB0aGlzLnZpc2l0ZWQgPSB0aGlzLnNvbHZlKEcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFnZW50IH0gZnJvbSBcIi4vQWdlbnRcIjtcbmltcG9ydCB7IE1hemUsIFRpbGVUeXBlIH0gZnJvbSBcIi4vTWF6ZVwiO1xuXG4vLyBQbG90bHkgaXMgaW1wb3J0ZWQgZ2xvYmFsbHksIHNvIGp1c3QgaW1wb3J0IGl0cyB0eXBlIGRlY2xhcmF0aW9uXG4vLyBzbyB3ZSBnZXQgY29kZSBjb21wbGV0aW9uIGFuZCB0eXBlIGNoZWNraW5nLlxuaW1wb3J0IHR5cGUgKiBhcyBQbG90bHlUeXBlIGZyb20gJ3Bsb3RseS5qcyc7XG5pbXBvcnQgeyBNYXplVmlldyB9IGZyb20gXCIuL01hemVWaWV3XCI7XG5kZWNsYXJlIGNvbnN0IFBsb3RseTogdHlwZW9mIFBsb3RseVR5cGU7XG5cbmNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XG5cbmZ1bmN0aW9uIGRlZmF1bHRNYXplKCk6IEFycmF5PEFycmF5PFRpbGVUeXBlPj4ge1xuICAgIGNvbnN0IHRpbGVzID0gTWF6ZS5FbXB0eU1hemUoNiwgNik7XG5cbiAgICAvLyA1LCA6NVxuICAgIHRpbGVzWzVdWzBdID0gVGlsZVR5cGUuV2FsbDtcbiAgICB0aWxlc1s1XVsxXSA9IFRpbGVUeXBlLldhbGw7XG4gICAgdGlsZXNbNV1bMl0gPSBUaWxlVHlwZS5XYWxsO1xuICAgIHRpbGVzWzVdWzNdID0gVGlsZVR5cGUuV2FsbDtcbiAgICB0aWxlc1s1XVs0XSA9IFRpbGVUeXBlLldhbGw7XG5cbiAgICAvLyA6NCwgNVxuICAgIHRpbGVzWzBdWzVdID0gVGlsZVR5cGUuV2FsbDtcbiAgICB0aWxlc1sxXVs1XSA9IFRpbGVUeXBlLldhbGw7XG4gICAgdGlsZXNbMl1bNV0gPSBUaWxlVHlwZS5XYWxsO1xuICAgIHRpbGVzWzNdWzVdID0gVGlsZVR5cGUuV2FsbDtcblxuICAgIC8vIDIsIDI6XG4gICAgdGlsZXNbMl1bMl0gPSBUaWxlVHlwZS5XYWxsO1xuICAgIHRpbGVzWzJdWzNdID0gVGlsZVR5cGUuV2FsbDtcbiAgICB0aWxlc1syXVs0XSA9IFRpbGVUeXBlLldhbGw7XG4gICAgdGlsZXNbMl1bNV0gPSBUaWxlVHlwZS5XYWxsO1xuXG4gICAgLy8gMywgMlxuICAgIHRpbGVzWzNdWzJdID0gVGlsZVR5cGUuV2FsbDtcblxuICAgIHJldHVybiB0aWxlcztcbn1cblxuZnVuY3Rpb24gaW5pdFRpbGVzKCk6IEFycmF5PEFycmF5PFRpbGVUeXBlPj4ge1xuICAgIGNvbnN0IHNhdmVkTWF6ZSA9IHVybFBhcmFtcy5nZXQoXCJtYXplXCIpO1xuXG4gICAgaWYgKHNhdmVkTWF6ZSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdE1hemUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gTWF6ZS5sb2FkVGlsZXMoc2F2ZWRNYXplKTtcbn1cblxuY29uc3QgdGlsZXMgPSBpbml0VGlsZXMoKTtcbmNvbnN0IG1hemUgPSBuZXcgTWF6ZSh0aWxlcyk7XG5cbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWF6ZVwiKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcbmNvbnN0IG1hemVWaWV3ID0gbmV3IE1hemVWaWV3KG1hemUsIGNhbnZhcyk7XG5tYXplVmlldy5yZW5kZXIoKTtcblxuZnVuY3Rpb24gcmVzaXplQ2FudmFzKCkge1xuICAgIGNvbnN0IGRwciA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvO1xuICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGNhbnZhcy53aWR0aCA9IE1hdGguY2VpbCh3aWR0aCAqIGRwcik7XG4gICAgY2FudmFzLmhlaWdodCA9IE1hdGguY2VpbChoZWlnaHQgKiBkcHIpO1xuICAgIG1hemVWaWV3LnJlbmRlcigpO1xufVxucmVzaXplQ2FudmFzKCk7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHJlc2l6ZUNhbnZhcywgZmFsc2UpO1xuXG5mdW5jdGlvbiB1cGRhdGVVUkkoKSB7XG4gICAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKG51bGwsIFwiTWF6ZVwiLCBcIj9tYXplPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KG1hemUuZW5jb2RlVGlsZXMoKSkpO1xufVxuXG5jYW52YXMub25jbGljayA9IChldmVudCkgPT4ge1xuXG4gICAgY29uc3QgcmVjdCA9IGNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuXG4gICAgY29uc3Qgcm93ID0gTWF0aC5mbG9vcihldmVudC5vZmZzZXRZICogbWF6ZS5oZWlnaHQgLyByZWN0LndpZHRoKTtcbiAgICBjb25zdCBjb2x1bW4gPSBNYXRoLmZsb29yKGV2ZW50Lm9mZnNldFggKiBtYXplLndpZHRoIC8gcmVjdC5oZWlnaHQpO1xuXG4gICAgbWF6ZS50b2dnbGVUaWxlKHJvdywgY29sdW1uKTtcbiAgICBtYXplVmlldy5yZW5kZXIoKTtcblxuICAgIHVwZGF0ZVVSSSgpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBzbGVlcCh0aW1lb3V0OiBudW1iZXIpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHRpbWVvdXQpKTtcbn1cblxuZnVuY3Rpb24gcGxvdE1vdmVIaXN0b3J5KG1vdmVIaXN0b3J5OiBBcnJheTxudW1iZXI+KSB7XG4gICAgY29uc3QgdHJhY2UxID0ge1xuICAgICAgICB4OiBtb3ZlSGlzdG9yeS5tYXAoKF8sIGkpID0+IGkpLFxuICAgICAgICB5OiBtb3ZlSGlzdG9yeSxcbiAgICAgICAgbW9kZTogJ2xpbmVzJ1xuICAgIH07XG5cbiAgICBjb25zdCBkYXRhID0gWyB0cmFjZTEgXTtcblxuICAgIGNvbnN0IGxheW91dDogUGFydGlhbDxQbG90bHlUeXBlLkxheW91dD4gPSB7XG4gICAgICAgIHRpdGxlOiAnTW92ZSBIaXN0b3J5JyxcbiAgICAgICAgeGF4aXM6IHtcbiAgICAgICAgICAgIHRpdGxlOiBcIkVwaXNvZGVzXCJcbiAgICAgICAgfSxcbiAgICAgICAgeWF4aXM6IHtcbiAgICAgICAgICAgIHRpdGxlOiBcIlN0ZXBDb3VudFwiXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgUGxvdGx5Lm5ld1Bsb3QoJ3Bsb3QnLCBkYXRhLCBsYXlvdXQpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBzdGFydCgpIHtcblxuICAgIGNvbnN0IGFscGhhID0gcGFyc2VGbG9hdCgoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbHBoYVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSlcbiAgICBpZiAoYWxwaGEgPCAwIHx8IGFscGhhID4gMSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiQWxwaGEgbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDFcIik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZXBzaWxvbiA9IHBhcnNlRmxvYXQoKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXBzaWxvblwiKSBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSlcbiAgICBpZiAoZXBzaWxvbiA8IDAgfHwgZXBzaWxvbiA+IDEpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVwc2lsb24gbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDFcIik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBtb3ZlSGlzdG9yeSA9IG5ldyBBcnJheTxudW1iZXI+KCk7XG4gICAgY29uc3Qgc3RhdGVzID0gQXJyYXkuZnJvbShBcnJheShtYXplLndpZHRoICogbWF6ZS5oZWlnaHQpLCAoXywgaSkgPT4gaSk7XG4gICAgY29uc3Qgcm9ib3QgPSBuZXcgQWdlbnQoc3RhdGVzLCBhbHBoYSwgZXBzaWxvbik7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1MDAwOyArK2kpIHtcblxuICAgICAgICB3aGlsZSAoIW1hemUuaXNHYW1lT3ZlcigpKSB7XG4gICAgICAgICAgICBjb25zdCBzdGF0ZSA9IG1hemUuZ2V0U3RhdGUoKTtcbiAgICAgICAgICAgIGNvbnN0IGFsbG93ZWRNb3ZlcyA9IG1hemUuZ2V0QWxsb3dlZE1vdmVzKHN0YXRlKSE7XG4gICAgICAgICAgICBjb25zdCBhY3Rpb24gPSByb2JvdC5jaG9vc2VBY3Rpb24oc3RhdGUsIGFsbG93ZWRNb3Zlcyk7XG4gICAgICAgICAgICBtYXplLnVwZGF0ZU1hemUoYWN0aW9uKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1N0YXRlID0gbWF6ZS5nZXRTdGF0ZSgpO1xuICAgICAgICAgICAgY29uc3QgcmV3YXJkID0gbWF6ZS5nZXRSZXdhcmQoKTtcbiAgICAgICAgICAgIHJvYm90LnVwZGF0ZVN0YXRlSGlzdG9yeShuZXdTdGF0ZSwgcmV3YXJkKTtcblxuICAgICAgICAgICAgaWYgKG1hemUuc3RlcHMgPiAxMDAwKSB7XG4gICAgICAgICAgICAgICAgbWF6ZS5zZXRSb2JvdFBvc2l0aW9uKG1hemUuaGVpZ2h0IC0xLCBtYXplLndpZHRoIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByb2JvdC5sZWFybigpO1xuICAgICAgICBtb3ZlSGlzdG9yeS5wdXNoKG1hemUuc3RlcHMpO1xuICAgICAgICBtYXplLnJlc2V0KCk7XG5cbiAgICAgICAgLy8gbWF6ZS5yZW5kZXIoY2FudmFzKTtcbiAgICAgICAgLy8gcmVuZGVyR1ZhbHVlcyhjYW52YXMsIHJvYm90LkcsIG1hemUpO1xuICAgICAgICAvLyBhd2FpdCBzbGVlcCgxMDAwKTtcbiAgICB9XG5cbiAgICBtYXplVmlldy5zZXRHKHJvYm90LkcpO1xuICAgIG1hemVWaWV3LnJlbmRlcigpO1xuICAgIHBsb3RNb3ZlSGlzdG9yeShtb3ZlSGlzdG9yeSk7XG59XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhcnRCdXR0b25cIikhLm9uY2xpY2sgPSBzdGFydDtcblxuY29uc3Qgd2lkdGhJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2lkdGhcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbmNvbnN0IGhlaWdodElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJoZWlnaHRcIikgYXMgSFRNTElucHV0RWxlbWVudDtcblxud2lkdGhJbnB1dC52YWx1ZSA9IG1hemUud2lkdGgudG9TdHJpbmcoKTtcbmhlaWdodElucHV0LnZhbHVlID0gbWF6ZS5oZWlnaHQudG9TdHJpbmcoKTtcblxuZnVuY3Rpb24gY2xhbXAobnVtOiBudW1iZXIsIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIG51bSA8PSBtaW4gPyBtaW4gOiBudW0gPj0gbWF4ID8gbWF4IDogbnVtO1xufVxuXG5mdW5jdGlvbiByZXNpemVNYXplKCkge1xuICAgIGNvbnN0IHdpZHRoID0gY2xhbXAoTnVtYmVyLnBhcnNlSW50KHdpZHRoSW5wdXQudmFsdWUpLCAxLCAxMjcpO1xuICAgIGNvbnN0IGhlaWdodCA9IGNsYW1wKE51bWJlci5wYXJzZUludChoZWlnaHRJbnB1dC52YWx1ZSksIDEsIDEyNyk7XG5cbiAgICBtYXplLnJlc2l6ZSh3aWR0aCwgaGVpZ2h0KTtcbiAgICBtYXplVmlldy5yZW5kZXIoKTtcbiAgICB1cGRhdGVVUkkoKTtcbn1cblxud2lkdGhJbnB1dC5vbmlucHV0ID0gcmVzaXplTWF6ZTtcbmhlaWdodElucHV0Lm9uaW5wdXQgPSByZXNpemVNYXplO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZVxuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbl9fd2VicGFja19yZXF1aXJlX18oOTY1KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=